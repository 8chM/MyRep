blueprint:
  name: Thermostatsteuerung mit Anwesenheitserkennung
  description: Steuert das Thermostat basierend auf der Anwesenheit
  domain: automation
  input:
    thermostat_entity:
      name: Thermostat-Entity
      description: Das zu steuernde Thermostat
      selector:
        entity:
          domain: climate
    presence_entity:
      name: Präsenz-Entity
      description: Die Entity, die den Anwesenheitsstatus enthält
      selector:
        entity:
          domain: device_tracker
    anwesenheit_1:
      name: Anwesenheit 1
      description: Erste Zeitspanne der Anwesenheit
      selector:
        time: {}
    anwesenheit_temp_1:
      name: Temperatur Anwesenheit 1
      description: Gewünschte Temperatur für die erste Zeitspanne der Anwesenheit
      selector:
        number:
          min: 5
          max: 40
          step: 0.5
    anwesenheit_2:
      name: Anwesenheit 2
      description: Zweite Zeitspanne der Anwesenheit
      selector:
        time: {}
    anwesenheit_temp_2:
      name: Temperatur Anwesenheit 2
      description: Gewünschte Temperatur für die zweite Zeitspanne der Anwesenheit
      selector:
        number:
          min: 5
          max: 40
          step: 0.5
    abwesenheit_temp:
      name: Temperatur Abwesenheit
      description: Gewünschte Temperatur während der Abwesenheit
      selector:
        number:
          min: 5
          max: 40
          step: 0.5
  trigger:
    platform: state
    entity_id: !input presence_entity
    from: "not_home"
    to: "home"
  action:
  - choose:
    - conditions:
      - condition: time
        after: !input anwesenheit_1
        before: !input anwesenheit_2
      sequence:
      - service: climate.set_temperature
        target:
          entity_id: !input thermostat_entity
        data:
          temperature: !input anwesenheit_temp_1
    - conditions:
      - condition: time
        after: !input anwesenheit_2
      sequence:
      - service: climate.set_temperature
        target:
          entity_id: !input thermostat_entity
        data:
          temperature: !input anwesenheit_temp_2
    default:
    - service: climate.set_temperature
      target:
        entity_id: !input thermostat_entity
      data:
        temperature: !input abwesenheit_temp
